
Given a set of points
a =  np.array(
       [[ 42, 206],   0
        [ 45,  40],   1
        [ 45, 205],   2
        [ 46,  41],   3
        [ 46, 205],   4
        [ 47,  40],   5
        [ 47, 202],   6
        [ 48,  40],   7
        [ 48, 202],   8
        [ 49,  38]])  9

    :Sorted array...
[[ 42 206]
 [ 45  40]
 [ 45 205]
 [ 46  41]
 [ 46 205]
 [ 47  40]
 [ 47 202]
 [ 48  40]
 [ 48 202]
 [ 49  38]]
:Distance sorted... 
[[ 0.0  166.0  3.2  165.0  4.1  166.1  6.4  166.1  7.2  168.1]
 [ 166.0  0.0  165.0  1.4  165.0  2.0  162.0  3.0  162.0  4.5]
 [ 3.2  165.0  0.0  164.0  1.0  165.0  3.6  165.0  4.2  167.0]
 [ 165.0  1.4  164.0  0.0  164.0  1.4  161.0  2.2  161.0  4.2]
 [ 4.1  165.0  1.0  164.0  0.0  165.0  3.2  165.0  3.6  167.0]
 [ 166.1  2.0  165.0  1.4  165.0  0.0  162.0  1.0  162.0  2.8]
 [ 6.4  162.0  3.6  161.0  3.2  162.0  0.0  162.0  1.0  164.0]
 [ 166.1  3.0  165.0  2.2  165.0  1.0  162.0  0.0  162.0  2.2]
 [ 7.2  162.0  4.2  161.0  3.6  162.0  1.0  162.0  0.0  164.0]
 [ 168.1  4.5  167.0  4.2  167.0  2.8  164.0  2.2  164.0  0.0]]    

u, v, w = near.n_near(a, 3)
       ID', 'Xo' 'Yo'   C0_X  C0_Y   C1_X  C1_Y   C2_X  C2_Y   Dist0     Dist1     Dist2
array([(0, 42.0, 206.0, 45.0, 205.0, 46.0, 205.0, 47.0, 202.0, 3.1622.., 4.1231.., 6.4031..),
       (1, 45.0,  40.0, 46.0,  41.0, 47.0,  40.0, 48.0,  40.0, 1.4142.., 2.0,      3.0     ),
       (2, 45.0, 205.0, 46.0, 205.0, 42.0, 206.0, 47.0, 202.0, 1.0,      3.1622.., 3.6055..),
       (3, 46.0,  41.0, 45.0,  40.0, 47.0,  40.0, 48.0,  40.0, 1.4142.., 1.4142.., 2.2360..),
       (4, 46.0, 205.0, 45.0, 205.0, 47.0, 202.0, 48.0, 202.0, 1.0,      3.1622.., 3.6055..),
       (5, 47.0,  40.0, 48.0,  40.0, 46.0,  41.0, 45.0,  40.0, 1.0,      1.4142.., 2.0     ),
       (6, 47.0, 202.0, 48.0, 202.0, 46.0, 205.0, 45.0, 205.0, 1.0,      3.1622.., 3.6055..),
       (7, 48.0,  40.0, 47.0,  40.0, 46.0,  41.0, 49.0,  38.0, 1.0,      2.2360.., 2.2360..),
       (8, 48.0, 202.0, 47.0, 202.0, 46.0, 205.0, 45.0, 205.0, 1.0,      3.6055.., 4.2426..),
       (9, 49.0,  38.0, 48.0,  40.0, 47.0,  40.0, 46.0,  41.0, 2.2360.., 2.8284.., 4.2426..)], 
      dtype=[('ID', '<i4'),
             ('Xo', '<f8'), ('Yo', '<f8'),
             ('C0_X', '<f8'), ('C0_Y', '<f8'),
             ('C1_X', '<f8'), ('C1_Y', '<f8'),
             ('C2_X', '<f8'), ('C2_Y', '<f8'),
             ('Dist0', '<f8'),
             ('Dist1', '<f8'),
             ('Dist2', '<f8')])
 
From To  dist    np.argsort(d[.....])
0    2   3.16    array([0, 2, 4, 6, 8, 3, 1, 5, 7, 9])  Y
1    3   1.414   array([1, 3, 5, 7, 9, 6, 8, 2, 4, 0])  Y
2    4   1.0     array([2, 4, 0, 6, 8, 3, 1, 5, 7, 9])  Y
3    1   1.414   array([3, 1, 5, 7, 9, 6, 8, 4, 2, 0])  Y
4    2   1.0     array([4, 2, 6, 8, 0, 3, 1, 5, 7, 9])  Y
5    7   1.0     array([5, 7, 3, 1, 9, 6, 8, 4, 2, 0])  Y
6    8   1.0     array([6, 8, 4, 2, 0, 3, 5, 7, 1, 9])
7    5   1.0     array([7, 5, 3, 9, 1, 8, 6, 4, 2, 0])  N
8    6   1.0     array([8, 6, 4, 2, 0, 3, 7, 5, 1, 9])  Y
9    7   2.236   array([9, 7, 5, 3, 1, 8, 6, 4, 2, 0])  Y


This doesn't work well either....

>>> du  triu array with 0 values set to np.inf

  [[ inf, 166.0,   3.2, 165.0,   4.1, 166.1,   6.4, 166.1,   7.2, 168.1],
   [ inf,   inf, 165.0,   1.4, 165.0,   2.0, 162.0,   3.0, 162.0,   4.5],
   [ inf,   inf,   inf, 164.0,   1.0, 165.0,   3.6, 165.0,   4.2, 167.0],
   [ inf,   inf,   inf,   inf, 164.0,   1.4, 161.0,   2.2, 161.0,   4.2],
   [ inf,   inf,   inf,   inf,   inf, 165.0,   3.2, 165.0,   3.6, 167.0],
   [ inf,   inf,   inf,   inf,   inf,   inf, 162.0,   1.0, 162.0,   2.8],
   [ inf,   inf,   inf,   inf,   inf,   inf,   inf, 162.0,   1.0, 164.0],
   [ inf,   inf,   inf,   inf,   inf,   inf,   inf,   inf, 162.0,   2.2],
   [ inf,   inf,   inf,   inf,   inf,   inf,   inf,   inf,   inf, 164.0],
   [ inf,   inf,   inf,   inf,   inf,   inf,   inf,   inf,   inf,  inf]])

>>> np.argsort(du, axis=1)
0   2 [[2, 4, 6, 8, 3, 1, 5, 7, 9, 0],
1   3  [3, 5, 7, 9, 6, 8, 2, 4, 0, 1],
2   4  [4, 6, 8, 3, 5, 7, 9, 0, 1, 2],
3   5  [5, 7, 9, 6, 8, 4, 0, 1, 2, 3],
4   6  [6, 8, 5, 7, 9, 0, 1, 2, 3, 4],
5   7  [7, 9, 6, 8, 0, 1, 2, 3, 4, 5],
6   8  [8, 7, 9, 0, 1, 2, 3, 4, 5, 6],
7   9  [9, 8, 0, 1, 2, 3, 4, 5, 6, 7],
8      [9, 0, 1, 2, 3, 4, 5, 6, 7, 8],
9      [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])

----------------------------------------------------

>>> di = np.arange(10)
>>> d[di,di] = np.inf
>>> d
  [[ inf,  166.0,  3.2,  165.0,  4.1,  166.1,  6.4,  166.1,  7.2,  168.1],
   [ 166.0,  inf,  165.0,  1.4,  165.0,  2.0,  162.0,  3.0,  162.0,  4.5],
   [ 3.2,  165.0,  inf,  164.0,  1.0,  165.0,  3.6,  165.0,  4.2,  167.0],
   [ 165.0,  1.4,  164.0,  inf,  164.0,  1.4,  161.0,  2.2,  161.0,  4.2],
   [ 4.1,  165.0,  1.0,  164.0,  inf,  165.0,  3.2,  165.0,  3.6,  167.0],
   [ 166.1,  2.0,  165.0,  1.4,  165.0,  inf,  162.0,  1.0,  162.0,  2.8],
   [ 6.4,  162.0,  3.6,  161.0,  3.2,  162.0,  inf,  162.0,  1.0,  164.0],
   [ 166.1,  3.0,  165.0,  2.2,  165.0,  1.0,  162.0,  inf,  162.0,  2.2],
   [ 7.2,  162.0,  4.2,  161.0,  3.6,  162.0,  1.0,  162.0,  inf,  164.0],
   [ 168.1,  4.5,  167.0,  4.2,  167.0,  2.8,  164.0,  2.2,  164.0,  inf]])
>>> ds = np.argsort(d, axis=1)
>>> ds
array([[2, 4, 6, 8, 3, 1, 5, 7, 9, 0],
       [3, 5, 7, 9, 6, 8, 2, 4, 0, 1],
       [4, 0, 6, 8, 3, 1, 5, 7, 9, 2],
       [1, 5, 7, 9, 6, 8, 4, 2, 0, 3],
       [2, 6, 8, 0, 3, 1, 5, 7, 9, 4],
       [7, 3, 1, 9, 6, 8, 4, 2, 0, 5],
       [8, 4, 2, 0, 3, 5, 7, 1, 9, 6],
       [5, 3, 9, 1, 8, 6, 4, 2, 0, 7],
       [6, 4, 2, 0, 3, 7, 5, 1, 9, 8],
       [7, 5, 3, 1, 8, 6, 4, 2, 0, 9]])
>>> st = np.vstack([d[i][ds[i]] for i in range(d.shape[0])])
>>> st
  [[ 3.2,  4.1,  6.4,  7.2,  165.0,  166.0,  166.1,  166.1,  168.1,  inf],
   [ 1.4,  2.0,  3.0,  4.5,  162.0,  162.0,  165.0,  165.0,  166.0,  inf],
   [ 1.0,  3.2,  3.6,  4.2,  164.0,  165.0,  165.0,  165.0,  167.0,  inf],
   [ 1.4,  1.4,  2.2,  4.2,  161.0,  161.0,  164.0,  164.0,  165.0,  inf],
   [ 1.0,  3.2,  3.6,  4.1,  164.0,  165.0,  165.0,  165.0,  167.0,  inf],
   [ 1.0,  1.4,  2.0,  2.8,  162.0,  162.0,  165.0,  165.0,  166.1,  inf],
   [ 1.0,  3.2,  3.6,  6.4,  161.0,  162.0,  162.0,  162.0,  164.0,  inf],
   [ 1.0,  2.2,  2.2,  3.0,  162.0,  162.0,  165.0,  165.0,  166.1,  inf],
   [ 1.0,  3.6,  4.2,  7.2,  161.0,  162.0,  162.0,  162.0,  164.0,  inf],
   [ 2.2,  2.8,  4.2,  4.5,  164.0,  164.0,  167.0,  167.0,  168.1,  inf]]
--------------------------------------------------

For the figure posted on github,

>>> a
array([[ 0,  0],
       [ 0,  8],
       [10,  8],
       [10,  0],
       [ 3,  4],
       [ 7,  4]])
>>> a_srt
array([[ 0,  0],
       [ 0,  8],
       [ 3,  4],
       [ 7,  4],
       [10,  0],
       [10,  8]])
>>> d
array([[ 0.0,  8.0,  5.0,  8.1,  10.0,  12.8],
       [ 8.0,  0.0,  5.0,  8.1,  12.8,  10.0],
       [ 5.0,  5.0,  0.0,  4.0,  8.1,  8.1],
       [ 8.1,  8.1,  4.0,  0.0,  5.0,  5.0],
       [ 10.0,  12.8,  8.1,  5.0,  0.0,  8.0],
       [ 12.8,  10.0,  8.1,  5.0,  8.0,  0.0]])
>>> pairs
array([[0, 2],
       [2, 3],
       [2, 1],
       [3, 4],
       [3, 5]])
>>> o_d
array([(0, 2, 5.0), (2, 3, 4.0), (2, 1, 5.0), (3, 4, 5.0), (3, 5, 5.0)], 
      dtype=[('Orig', '<i4'), ('Dest', '<i4'), ('Dist', '<f8')])
